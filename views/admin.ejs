<% include('partials/header', { 
    pageTitle: 'MockERP Pro - Admin Configuration',
    activePage: 'admin',
    showStatus: false
}) %>
        <% if (message) { %>
        <div class="alert alert-success">
            <%= message %>
        </div>
        <% } %>
        
        <section class="admin-section">
            <h2>ğŸ› ï¸ Integration Configuration</h2>
            
            <div class="config-card">
                <h3>ğŸ” Setup Credentials</h3>
                <form action="/api/save-credentials" method="POST">
                    <div class="form-group">
                        <label for="email">Alchemy Email</label>
                        <input type="email" id="email" name="email" value="<%= config.email %>" placeholder="your-email@example.com">
                        <small>Leave blank to keep existing value</small>
                    </div>
                    <div class="form-group">
                        <label for="password">Alchemy Password</label>
                        <input type="password" id="password" name="password" placeholder="<%= config.hasPassword ? 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢' : 'Enter password' %>">
                        <small><%= config.hasPassword ? 'âœ“ Password is set. Leave blank to keep existing.' : 'âš ï¸ Password not yet configured.' %></small>
                    </div>
                    <div class="form-group">
                        <label for="tenant">Tenant Name</label>
                        <input type="text" id="tenant" name="tenant" value="<%= config.tenant %>" required>
                        <small>Common tenants: productcaseelnlims, ppelnlims  ect</small>
                    </div>
                    <div class="form-group">
                        <label for="materialType">Material Type ID</label>
                        <input type="number" id="materialType" name="materialType" value="<%= config.materialType %>" required>
                        <small>Find this in Alchemy Admin Panel â†’ Material Types</small>
                    </div>
                    <button type="submit" class="btn btn-primary">ğŸ’¾ Save Configuration</button>
                </form>
            </div>

            <div class="config-card">
                <h3>ğŸ“‹ Current Configuration</h3>
                <div class="config-info">
                    <div class="config-item">
                        <label>Alchemy Email:</label>
                        <span><%= config.email || 'Not configured' %></span>
                    </div>
                    <div class="config-item">
                        <label>Password Status:</label>
                        <span><%= config.hasPassword ? 'âœ… Configured' : 'âŒ Not configured' %></span>
                    </div>
                    <div class="config-item">
                        <label>Tenant:</label>
                        <span><%= config.tenant %></span>
                    </div>
                    <div class="config-item">
                        <label>Material Type ID:</label>
                        <span><%= config.materialType %></span>
                    </div>
                    <div class="config-item">
                        <label>API URL:</label>
                        <span><%= config.apiUrl %></span>
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-primary" onclick="testConnection()">ğŸ”— Test Connection</button>
                    <button class="btn btn-secondary" onclick="changeTenant()">ğŸ”„ Quick Change Tenant</button>
                    <button class="btn btn-secondary" onclick="clearToken()">ğŸ—‘ï¸ Clear Stored Token</button>
                </div>
                <div id="connectionResult" class="connection-result"></div>
            </div>

            <div class="config-card">
                <h3>ğŸš€ Quick Start Guide</h3>
                <div class="instructions">
                    <p><strong>Getting Started:</strong></p>
                    <ol>
                        <li>Enter your Alchemy credentials in the form above</li>
                        <li>Set your tenant name (e.g., productcaseelnlims)</li>
                        <li>Find your Material Type ID in Alchemy Admin Panel â†’ Material Types</li>
                        <li>Save the configuration</li>
                        <li>Test the connection to verify everything works</li>
                    </ol>
                    <p><strong>Additional Features:</strong></p>
                    <ul>
                        <li><strong>ğŸ”„ Quick Change Tenant</strong> - Switch between tenants without re-entering credentials</li>
                        <li><strong>ğŸ—‘ï¸ Clear Stored Token</strong> - Force re-authentication on next API call</li>
                        <li><strong>â†©ï¸ Revert Materials</strong> - Reset transferred materials back to pending status</li>
                        <li><strong>ğŸ—‘ï¸ Delete Materials</strong> - Remove materials from the system</li>
                    </ul>
                    <div style="margin-top: 1rem; padding: 1rem; background: #fef3c7; border-radius: 8px; border: 1px solid #fbbf24;">
                        <p style="color: #92400e; font-weight: 500;">âš ï¸ <strong></strong></p>
                        <p style="color: #92400e; font-size: 0.875rem;"></p>
                    </div>
                </div>
            </div>

            <div class="config-card">
                <h3>ğŸ“Š Integration Statistics</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <h4>ğŸ”Œ API Endpoint</h4>
                        <p>Alchemy Cloud v2</p>
                    </div>
                    <div class="stat-item">
                        <h4>ğŸ” Authentication</h4>
                        <p>JWT Token (Bearer)</p>
                    </div>
                    <div class="stat-item">
                        <h4>ğŸ”— Integration Type</h4>
                        <p>REST API</p>
                    </div>
                    <div class="stat-item">
                        <h4>ğŸ“¤ Data Flow</h4>
                        <p>One-way (ERP â†’ Alchemy)</p>
                    </div>
                </div>
            </div>

            <div class="config-card">
                <h3>âœ¨ Demo Features</h3>
                <ul class="feature-list">
                    <li>Simulates enterprise material management system</li>
                    <li>Demonstrates API authentication patterns</li>
                    <li>Shows real-time data synchronization</li>
                    <li>Includes error handling and retry logic</li>
                    <li>Provides direct links to created materials in Alchemy</li>
                    <li>Supports multiple tenants through configuration</li>
                </ul>
            </div>
        </section>
<% include('partials/footer', {
    connectionStatus: config.email ? 'Configured' : 'Not Configured'
}) %>
